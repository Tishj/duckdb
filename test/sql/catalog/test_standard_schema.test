# name: test/sql/catalog/test_standard_schema.test
# description: Schema creation/deletion
# group: [catalog]

# cannot drop MAIN schema
statement error
DROP SCHEMA main CASCADE;
----
Catalog Error: Cannot drop entry "main" because it is an internal system entry

# create and drop an empty schema
statement ok
CREATE SCHEMA test;

statement ok
DROP SCHEMA test;

# create the schema again
statement ok
CREATE SCHEMA test;

# duplicate schema
statement error
CREATE SCHEMA test;
----
Catalog Error: Schema with name test already exists!

# if not exists ignores error
statement ok
CREATE SCHEMA IF NOT EXISTS test;

# create table inside schema that exists should succeed
statement ok
CREATE TABLE test.hello(i INTEGER);

# create table inside schema that does not exist should fail
statement error
CREATE TABLE test2.hello(i INTEGER);
----
Catalog Error: Schema with name test2 does not exist!

# use the table in queries
# insert into table
statement ok
INSERT INTO test.hello VALUES (2), (3), (4)

# select from table without schema specified should fail
statement error
SELECT * FROM hello
----
Catalog Error: Table with name hello does not exist!
Did you mean "test.hello"?
LINE 1: SELECT * FROM hello
                      ^

# with schema specified should succeed
query I
SELECT * FROM test.hello
----
2
3
4

# drop schema with dependencies should fail
statement error
DROP SCHEMA test;
----
Dependency Error: Cannot drop entry "test" because there are entries that depend on it. Use DROP...CASCADE to drop all dependents.

# unless we use cascade to drop
statement ok
DROP SCHEMA test CASCADE;

# drop schema if exists should not fail if schema does not exist
statement ok
DROP SCHEMA IF EXISTS test;

# but drop schema without it should fail
statement error
DROP SCHEMA test;
----
Catalog Error: Schema with name "test" does not exist!

