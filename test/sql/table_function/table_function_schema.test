# name: test/sql/table_function/table_function_schema.test
# group: [table_function]

statement ok
pragma enable_verification;

# No schema provided
query III
select * from repeat_row(5, true, 'test', num_rows = 5)
----
5	true	test
5	true	test
5	true	test
5	true	test
5	true	test

# Full schema
query II
select * from repeat_row(5, true, num_rows=2) as (a integer, b varchar);
----
5	true
5	true

# Partial schema
statement error
select * from repeat_row(5, true, num_rows=2) as (a, b varchar);
----
syntax error at or near ","

# Partial schema
statement error
select * from repeat_row(5, true, num_rows=2) as (a integer, b);
----
syntax error at or near ")"

# Additional columns in the schema (are ignored)
query II
select * from repeat_row(5, true, num_rows=2) as (a integer, b varchar, c boolean);
----
5	true
5	true

# Only a subset of columns are provided: only emit those columns
query I
select * from repeat_row(5, true, num_rows=2) as (a integer);
----
5
5
