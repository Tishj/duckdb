# name: test/sql/table_function/user_specified_schema.test
# group: [table_function]

statement ok
pragma enable_verification;

# Select only a subset of columns
query IIII
select * from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, b integer, c integer, d varchar);
----
1	2	3	bla
1	2	3	bla

# Cast a column to another type than the original type
query I
select typeof(b) from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, b VARCHAR);
----
VARCHAR
VARCHAR

# Select an even smaller subset of columns
query II
select * from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, b integer);
----
1	2
1	2

# Select only one column from the projection
query I
select b from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, b integer, c integer, d integer);
----
2
2

# Too many columns
statement error
select * from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, b integer, c integer, d varchar, e integer, f integer);
----
The provided schema contains 6 columns, but the function only returns 5 columns

# Duplicate name
statement error
select * from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, a integer);
----
table "read_csv" has duplicate column name "a"

# Data could not be cast to type
statement error
select * from read_csv('data/csv/multiple_files/more_columns/file_3.csv') as (a integer, b integer, c integer, d integer);
----
Could not convert string 'bla' to INT32
