# name: test/sql/function/list/list_resize_error.test
# description: test for list_resize() that should error
# group: [list]

statement ok
PRAGMA enable_verification;

statement ok
prepare q1 as select list_resize(?, ?);

statement ok
prepare q2 as select array_resize(?, ?);

foreach q q1 q2

statement error
execute ${q}([1, 2, 3], -1);
----
Conversion Error: Type INT32 with value -1 can't be cast because the value is out of range for the destination type UINT64

statement error
execute ${q}([1, 2, 3], 'a');
----
Conversion Error: Could not convert string 'a' to UINT64

statement error
execute ${q}('cici n est pas een list', 2);
----
Binder Error: No function matches the given name and argument types

statement error
execute ${q}([1, 2, 3], 'huh');
----
Conversion Error: Could not convert string 'huh' to UINT64

statement error
execute ${q}();
----
Parser Error: syntax error at or near ")"

statement error
execute ${q}([1, 2, 3]);
----
Invalid Input Error: Values were not provided for the following prepared statement parameters: 2

endloop

statement ok
prepare q3 as select list_resize(?, ?, ?);

statement ok
prepare q4 as select array_resize(?, ?, ?);

foreach q q3 q4

statement error
execute ${q}([1, 2, 3], 5, 'abc');
----
Conversion Error: Could not convert string 'abc' to INT32

statement error
execute ${q}([1, 2, 3], 2, 3, 4);
----
Invalid Input Error: Parameter argument/count mismatch, identifiers of the excess parameters: 4

statement error
execute ${q}([1, 2, 3], 1, [1, 2, 3]);
----
Conversion Error: Unimplemented type for cast (INTEGER[] -> INTEGER)

endloop
