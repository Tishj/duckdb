# name: test/sql/function/list/list_resize_error.test
# description: test for list_resize() that should error
# group: [list]

statement ok
PRAGMA enable_verification;

statement ok
prepare q1 as select list_resize(?, ?);

statement ok
prepare q2 as select array_resize(?, ?);

foreach q q1 q2

statement error
execute ${q}([1, 2, 3], -1);
----
PLACEHOLDER_ERROR_MESSAGE2269

statement error
execute ${q}([1, 2, 3], 'a');
----
PLACEHOLDER_ERROR_MESSAGE2268

statement error
execute ${q}('cici n est pas een list', 2);
----
PLACEHOLDER_ERROR_MESSAGE2267

statement error
execute ${q}([1, 2, 3], 'huh');
----
Conversion Error: Could not convert string 'huh' to UINT64

statement error
execute ${q}();
----
PLACEHOLDER_ERROR_MESSAGE2266

statement error
execute ${q}([1, 2, 3]);
----
PLACEHOLDER_ERROR_MESSAGE2265

endloop

statement ok
prepare q3 as select list_resize(?, ?, ?);

statement ok
prepare q4 as select array_resize(?, ?, ?);

foreach q q3 q4

statement error
execute ${q}([1, 2, 3], 5, 'abc');
----
Conversion Error: Could not convert string 'abc' to INT32

statement error
execute ${q}([1, 2, 3], 2, 3, 4);
----
PLACEHOLDER_ERROR_MESSAGE2264

statement error
execute ${q}([1, 2, 3], 1, [1, 2, 3]);
----
Conversion Error: Unimplemented type for cast (INTEGER[] -> INTEGER)

endloop
