# name: test/sql/copy/parquet/broken_parquet.test
# description: Read several broken parquet files
# group: [parquet]

require parquet

statement ok
PRAGMA enable_verification

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/missingmagicatfront.parquet')
----
Invalid Input Error: Footer length error in file 'test/sql/copy/parquet/broken/missingmagicatfront.parquet'

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/missingmagicatend.parquet')
----
Invalid Input Error: No magic bytes found at end of file 'test/sql/copy/parquet/broken/missingmagicatend.parquet'

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/firstmarker.parquet')
----
Invalid Input Error: File 'test/sql/copy/parquet/broken/firstmarker.parquet' too small to be a Parquet file

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/twomarkers.parquet')
----
Invalid Input Error: File 'test/sql/copy/parquet/broken/twomarkers.parquet' too small to be a Parquet file

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/footerlengthzero.parquet')
----
Invalid Input Error: Footer length error in file 'test/sql/copy/parquet/broken/footerlengthzero.parquet'

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/hugefooter.parquet')
----
Invalid Input Error: Footer length error in file 'test/sql/copy/parquet/broken/hugefooter.parquet'

statement error
select count(*) from parquet_scan('test/sql/copy/parquet/broken/garbledfooter.parquet')
----
Invalid Error: TProtocolException: Invalid data
