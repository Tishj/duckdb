# name: test/sql/copy/csv/csv_external_access.test
# description: Test that enable_external_access blocks CSV readers
# group: [csv]

statement ok
CREATE TABLE date_test(d date);

statement ok
COPY date_test FROM 'test/sql/copy/csv/data/test/date.csv';

statement ok
SET enable_external_access=false;

statement error
SELECT * FROM read_csv('test/sql/copy/csv/data/test/date.csv', columns = {'d': 'DATE'});
----
PLACEHOLDER_ERROR_MESSAGE2906

statement error
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/date.csv');
----
PLACEHOLDER_ERROR_MESSAGE2905

statement error
COPY date_test FROM 'test/sql/copy/csv/data/test/date.csv';
----
PLACEHOLDER_ERROR_MESSAGE2904

statement error
COPY date_test TO '__TEST_DIR__/date.csv'
----
PLACEHOLDER_ERROR_MESSAGE2903

# we also can't just enable external access again
statement error
SET enable_external_access=true;
----
PLACEHOLDER_ERROR_MESSAGE2902
