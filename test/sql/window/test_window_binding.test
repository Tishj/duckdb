# name: test/sql/window/test_window_binding.test
# description: Test errors in binding window functions
# group: [window]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE integers(i INTEGER)

# we use columns here that are not part of the table
statement error
SELECT MIN(a) OVER (PARTITION BY i ORDER BY i) FROM integers
----
Binder Error: Referenced column "a" not found in FROM clause!
Candidate bindings: "integers.i"

statement error
SELECT MIN(i) OVER (PARTITION BY a ORDER BY i) FROM integers
----
Binder Error: Referenced column "a" not found in FROM clause!
Candidate bindings: "integers.i"

statement error
SELECT MIN(i) OVER (PARTITION BY i ORDER BY a) FROM integers
----
PLACEHOLDER_ERROR_MESSAGE2798

statement error
SELECT MIN(i) OVER (PARTITION BY i, a ORDER BY i) FROM integers
----
PLACEHOLDER_ERROR_MESSAGE2797

statement error
SELECT MIN(i) OVER (PARTITION BY i ORDER BY i, a) FROM integers
----
PLACEHOLDER_ERROR_MESSAGE2796

# now we only use the "proper" columns
query I
SELECT MIN(i) OVER (PARTITION BY i ORDER BY i) FROM integers
----

