# name: test/sql/window/test_window_distinct.test_slow
# description: Windowed distinct aggregates at scale
# group: [window]

statement ok
PRAGMA temp_directory='__TEST_DIR__/window_distinct'

# Trigger external sorting of a partition
statement ok
PRAGMA threads=4

statement ok
PRAGMA memory_limit='40MB'

statement ok
WITH t AS (
	SELECT range AS i, CHR((65 + i % 26)::INTEGER) AS c
	FROM range(1e6::BIGINT) 
)
SELECT i, c, COUNT(DISTINCT c) OVER (ORDER BY i DESC) AS n
FROM t
ORDER BY ALL
