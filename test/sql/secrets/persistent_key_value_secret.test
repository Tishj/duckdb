# name: test/sql/secrets/persistent_key_value_secret.test
# group: [secrets]

load __TEST_DIR__/persistent_extra_headers

require httpfs

require json

statement ok
CREATE PERSISTENT SECRET http (
	TYPE HTTP,
	EXTRA_HTTP_HEADERS MAP {
		'Authorization': 'Bearer sk_test_not_valid_key'
	}
);

restart

statement error
select
	unnest(data) as customers
from
	read_json('https://api.stripe.com/v1/customers');
----
401
