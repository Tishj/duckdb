# name: test/sql/prepared/invalid_prepare.test
# description: Test invalid prepare statements
# group: [prepared]

# cannot execute a statement with prepared statement parameters
statement error
select ?;
----
Invalid Error: Expected 1 parameters, but none were supplied

# cannot create a view with prepared statement parameters
statement error
create view v1 as select ?;
----
Binder Error: Unexpected prepared parameter. This type of statement can't be prepared!

# start with a higher index than 1
statement ok
prepare v1 as select $2::int;

statement error
execute v1(0);
----
Invalid Input Error: Values were not provided for the following prepared statement parameters: 2

# cannot cast from varchar to int
statement ok
prepare v2 as select $1::int;

statement error
execute v2('hello');
----
Conversion Error: Could not convert string 'hello' to INT32

statement ok
prepare v3 as select $1::int where 1=0;

statement ok
execute v3(1);
