# name: test/sql/aggregate/aggregates/test_aggregate_types_scalar.test
# description: Test scalar aggregates with many different types
# group: [aggregates]

query IIIIII
SELECT COUNT(), COUNT(1), COUNT(*), COUNT(NULL), COUNT('hello'), COUNT(DATE '1992-02-02')
----
1
1
1
0
1
1

statement error
SELECT COUNT(1, 2)
----
Binder Error: No function matches the given name and argument types 'count(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	count(ANY) -> BIGINT
	count() -> BIGINT

query RRR
SELECT SUM(1), SUM(NULL), SUM(33.3)
----
1.000000
NULL
33.3

statement error
SELECT SUM(True)
----
Binder Error: No function matches the given name and argument types 'sum(BOOLEAN)'. You might need to add explicit type casts.
	Candidate functions:
	sum(DECIMAL) -> DECIMAL
	sum(SMALLINT) -> HUGEINT
	sum(INTEGER) -> HUGEINT
	sum(BIGINT) -> HUGEINT
	sum(HUGEINT) -> HUGEINT
	sum(DOUBLE) -> DOUBLE

statement error
SELECT SUM('hello')
----
Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
	Candidate functions:
	sum(DECIMAL) -> DECIMAL
	sum(SMALLINT) -> HUGEINT
	sum(INTEGER) -> HUGEINT
	sum(BIGINT) -> HUGEINT
	sum(HUGEINT) -> HUGEINT
	sum(DOUBLE) -> DOUBLE

statement error
SELECT SUM(DATE '1992-02-02')
----
Binder Error: No function matches the given name and argument types 'sum(DATE)'. You might need to add explicit type casts.
	Candidate functions:
	sum(DECIMAL) -> DECIMAL
	sum(SMALLINT) -> HUGEINT
	sum(INTEGER) -> HUGEINT
	sum(BIGINT) -> HUGEINT
	sum(HUGEINT) -> HUGEINT
	sum(DOUBLE) -> DOUBLE

statement error
SELECT SUM()
----
Binder Error: No function matches the given name and argument types 'sum()'. You might need to add explicit type casts.
	Candidate functions:
	sum(DECIMAL) -> DECIMAL
	sum(SMALLINT) -> HUGEINT
	sum(INTEGER) -> HUGEINT
	sum(BIGINT) -> HUGEINT
	sum(HUGEINT) -> HUGEINT
	sum(DOUBLE) -> DOUBLE

statement error
SELECT SUM(1, 2)
----
Binder Error: No function matches the given name and argument types 'sum(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	sum(DECIMAL) -> DECIMAL
	sum(SMALLINT) -> HUGEINT
	sum(INTEGER) -> HUGEINT
	sum(BIGINT) -> HUGEINT
	sum(HUGEINT) -> HUGEINT
	sum(DOUBLE) -> DOUBLE

query IIRTTTT
SELECT MIN(1), MIN(NULL), MIN(33.3), MIN('hello'), MIN(True), MIN(DATE '1992-02-02'), MIN(TIMESTAMP '2008-01-01 00:00:01')
----
1	NULL	33.3	hello	1	1992-02-02	2008-01-01 00:00:01

statement error
SELECT MIN()
----
Binder Error: No function matches the given name and argument types 'min()'. You might need to add explicit type casts.
	Candidate functions:
	min(DECIMAL) -> DECIMAL
	min(ANY) -> ANY

statement error
SELECT MIN(1, 2)
----
Binder Error: No function matches the given name and argument types 'min(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	min(DECIMAL) -> DECIMAL
	min(ANY) -> ANY

query IIRTTTT
SELECT MAX(1), MAX(NULL), MAX(33.3), MAX('hello'), MAX(True), MAX(DATE '1992-02-02'), MAX(TIMESTAMP '2008-01-01 00:00:01')
----
1	NULL	33.3	hello	1	1992-02-02	2008-01-01 00:00:01

statement error
SELECT MAX()
----
Binder Error: No function matches the given name and argument types 'max()'. You might need to add explicit type casts.
	Candidate functions:
	max(DECIMAL) -> DECIMAL
	max(ANY) -> ANY

statement error
SELECT MAX(1, 2)
----
Binder Error: No function matches the given name and argument types 'max(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	max(DECIMAL) -> DECIMAL
	max(ANY) -> ANY

query IIRTTTT
SELECT FIRST(1), FIRST(NULL), FIRST(33.3), FIRST('hello'), FIRST(True), FIRST(DATE '1992-02-02'), FIRST(TIMESTAMP '2008-01-01 00:00:01')
----
1	NULL	33.3	hello	1	1992-02-02	2008-01-01 00:00:01

statement error
SELECT FIRST()
----
Binder Error: No function matches the given name and argument types 'first()'. You might need to add explicit type casts.
	Candidate functions:
	first(DECIMAL) -> DECIMAL
	first(ANY) -> ANY

statement error
SELECT FIRST(1, 2)
----
Binder Error: No function matches the given name and argument types 'first(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	first(DECIMAL) -> DECIMAL
	first(ANY) -> ANY

query IIRTTTT
SELECT LAST(1), LAST(NULL), LAST(33.3), LAST('hello'), LAST(True), LAST(DATE '1992-02-02'), LAST(TIMESTAMP '2008-01-01 00:00:01')
----
1	NULL	33.3	hello	1	1992-02-02	2008-01-01 00:00:01

statement error
SELECT LAST()
----
Binder Error: No function matches the given name and argument types 'last()'. You might need to add explicit type casts.
	Candidate functions:
	last(DECIMAL) -> DECIMAL
	last(ANY) -> ANY

statement error
SELECT LAST(1, 2)
----
Binder Error: No function matches the given name and argument types 'last(INTEGER, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	last(DECIMAL) -> DECIMAL
	last(ANY) -> ANY

query RRR
SELECT AVG(1), AVG(NULL), AVG(33.3)
----
1.000000	NULL	33.3

statement error
SELECT AVG(True)
----
Binder Error: No function matches the given name and argument types 'avg(BOOLEAN)'. You might need to add explicit type casts.
	Candidate functions:
	avg(DECIMAL) -> DECIMAL
	avg(SMALLINT) -> DOUBLE
	avg(INTEGER) -> DOUBLE
	avg(BIGINT) -> DOUBLE
	avg(HUGEINT) -> DOUBLE
	avg(DOUBLE) -> DOUBLE

statement error
SELECT AVG('hello')
----
Binder Error: No function matches the given name and argument types 'avg(VARCHAR)'. You might need to add explicit type casts.
	Candidate functions:
	avg(DECIMAL) -> DECIMAL
	avg(SMALLINT) -> DOUBLE
	avg(INTEGER) -> DOUBLE
	avg(BIGINT) -> DOUBLE
	avg(HUGEINT) -> DOUBLE
	avg(DOUBLE) -> DOUBLE

statement error
SELECT AVG(DATE '1992-02-02')
----
PLACEHOLDER_ERROR_MESSAGE1620

statement error
SELECT AVG()
----
PLACEHOLDER_ERROR_MESSAGE1619

statement error
SELECT AVG(1, 2)
----
PLACEHOLDER_ERROR_MESSAGE1618

query T
SELECT STRING_AGG('hello')
----
hello

query TTTTT
SELECT STRING_AGG('hello', ' '), STRING_AGG('hello', NULL), STRING_AGG(NULL, ' '), STRING_AGG(NULL, NULL), STRING_AGG('', '')
----
hello	NULL	NULL	NULL	(empty)

statement error
SELECT STRING_AGG()
----
PLACEHOLDER_ERROR_MESSAGE1617

statement error
SELECT STRING_AGG(1, 2, 3)
----
PLACEHOLDER_ERROR_MESSAGE1616

statement ok
CREATE TABLE test_val(val INT)

statement ok
INSERT INTO test_val VALUES(1), (2), (3), (3), (2)

query T
SELECT STRING_AGG(DISTINCT val ORDER BY val DESC) from test_val;
----
3,2,1

query IT
SELECT COUNT(NULL), STRING_AGG(DISTINCT val ORDER BY val ASC) from test_val;
----
0
1,2,3

