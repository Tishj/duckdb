# name: test/sql/generated_columns/virtual/unique.test
# description: Test the UNIQUE constraint together with generated columns
# group: [virtual]

# Create a table with a generated column with a UNIQUE constraint

#Primary key is not supported on a (virtual) generated column
statement ok
CREATE TABLE tbl (
	price INTEGER,
	other INTEGER,
	pkey AS (price + other),
	pkeyy AS (pkey) UNIQUE
);

statement ok
INSERT INTO tbl VALUES (5, 3);

#Violates unique constraint
statement error
INSERT INTO tbl VALUES (3, 5);

query IIII
SELECT * FROM tbl;
----
5	3	8	8
