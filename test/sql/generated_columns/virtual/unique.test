# name: test/sql/generated_columns/virtual/unique.test
# description: Test the UNIQUE constraint together with generated columns
# group: [virtual]

# Create a table with a generated column with a UNIQUE constraint

#Primary key is not supported on a (virtual) generated column
statement ok
CREATE TABLE tbl (
	price INTEGER,
	other INTEGER,
	pkey AS (price + other),
	pkeyy AS (pkey) UNIQUE
);

statement ok
INSERT INTO tbl VALUES (5, 3);

statement ok
INSERT INTO tbl VALUES (5, 3);

statement error
SELECT * FROM tbl;
#----
#5	3	8
#5	1	6
