# name: test/sql/types/unsigned/test_unsigned_conversion.test
# description: Test unsigned conversion
# group: [unsigned]

statement ok
PRAGMA enable_verification

# Numbers that fit the unsigned types
query III
SELECT '7'::UTINYINT, '130'::UTINYINT, '255'::UTINYINT
----
7	130	255

query III
SELECT '7'::USMALLINT, '130'::USMALLINT, '65535'::USMALLINT
----
7	130	65535

query III
SELECT '7'::UINTEGER, '130'::UINTEGER, '4294967295'::UINTEGER
----
7	130	4294967295

query III
SELECT '7'::UBIGINT, '130'::UBIGINT, '18446744073709551615'::UBIGINT
----
7	130	18446744073709551615

# Numbers that do not fit the unsigned type
statement error
SELECT '265'::UTINYINT
----
Conversion Error: Could not convert string '265' to UINT8

statement error
SELECT '65536'::USMALLINT
----
Conversion Error: Could not convert string '65536' to UINT16

statement error
SELECT '4294967296'::UINTEGER
----
Conversion Error: Could not convert string '4294967296' to UINT32

statement error
SELECT '18446744073709551616'::UBIGINT
----
Conversion Error: Could not convert string '18446744073709551616' to UINT64

# Negative Numbers
statement error
SELECT '-1'::UTINYINT
----
Conversion Error: Could not convert string '-1' to UINT8

statement error
SELECT '-1'::USMALLINT
----
Conversion Error: Could not convert string '-1' to UINT16

statement error
SELECT '-1'::UINTEGER
----
Conversion Error: Could not convert string '-1' to UINT32

statement error
SELECT '-1'::UBIGINT
----
Conversion Error: Could not convert string '-1' to UINT64

# zero
query II
SELECT '0'::UTINYINT, '-0'::UTINYINT
----
0	0


# cast various types to unsigned
query IIIIII
SELECT 42::TINYINT::UTINYINT, 42::SMALLINT::UTINYINT, 42::INTEGER::UTINYINT, 42::BIGINT::UTINYINT, 42::FLOAT::UTINYINT, 42::DOUBLE::UTINYINT;
----
42	42	42	42	42	42

query IIIIII
SELECT 42::TINYINT::USMALLINT, 42::SMALLINT::USMALLINT, 42::INTEGER::USMALLINT, 42::BIGINT::USMALLINT, 42::FLOAT::USMALLINT, 42::DOUBLE::USMALLINT;
----
42	42	42	42	42	42

query IIIIII
SELECT 42::TINYINT::UINTEGER, 42::SMALLINT::UINTEGER, 42::INTEGER::UINTEGER, 42::BIGINT::UINTEGER, 42::FLOAT::UINTEGER, 42::DOUBLE::UINTEGER;
----
42	42	42	42	42	42

query IIIIII
SELECT 42::TINYINT::UBIGINT, 42::SMALLINT::UBIGINT, 42::INTEGER::UBIGINT, 42::BIGINT::UBIGINT, 42::FLOAT::UBIGINT, 42::DOUBLE::UBIGINT;
----
42	42	42	42	42	42

# cast various types to unsigned (Larger than they can fit)
statement error
SELECT (9223372036854775807)::BIGINT::UTINYINT
----
Conversion Error: Type INT64 with value 9223372036854775807 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (9223372036854775807)::BIGINT::USMALLINT
----
Conversion Error: Type INT64 with value 9223372036854775807 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (9223372036854775807)::BIGINT::UINTEGER
----
Conversion Error: Type INT64 with value 9223372036854775807 can't be cast because the value is out of range for the destination type UINT32

# These should fit though
query I
SELECT (9223372036854775807)::BIGINT::UBIGINT
----
9223372036854775807

query I
SELECT (9223372036854775808)::HUGEINT::UBIGINT
----
9223372036854775808

# Negative Values
statement error
SELECT (-42)::TINYINT::UTINYINT
----
Conversion Error: Type INT8 with value -42 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (-42)::TINYINT::USMALLINT
----
Conversion Error: Type INT8 with value -42 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (-42)::TINYINT::UINTEGER
----
Conversion Error: Type INT8 with value -42 can't be cast because the value is out of range for the destination type UINT32

statement error
SELECT (-42)::TINYINT::UBIGINT
----
Conversion Error: Type INT8 with value -42 can't be cast because the value is out of range for the destination type UINT64

query I
SELECT -42::TINYINT::UTINYINT
----
214

query I
SELECT -42::TINYINT::USMALLINT
----
65494

query I
SELECT -42::TINYINT::UINTEGER
----
4294967254

query I
SELECT -42::TINYINT::UBIGINT
----
18446744073709551574

statement error
SELECT (-42)::SMALLINT::UTINYINT
----
Conversion Error: Type INT16 with value -42 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (-42)::SMALLINT::USMALLINT
----
Conversion Error: Type INT16 with value -42 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (-42)::SMALLINT::UINTEGER
----
Conversion Error: Type INT16 with value -42 can't be cast because the value is out of range for the destination type UINT32

statement error
SELECT (-42)::SMALLINT::UBIGINT
----
Conversion Error: Type INT16 with value -42 can't be cast because the value is out of range for the destination type UINT64

query I
SELECT -42::SMALLINT::UTINYINT
----
214

query I
SELECT -42::SMALLINT::USMALLINT
----
65494

query I
SELECT -42::SMALLINT::UINTEGER
----
4294967254

query I
SELECT -42::SMALLINT::UBIGINT
----
18446744073709551574

statement error
SELECT (-42)::INTEGER::UTINYINT
----
Conversion Error: Type INT32 with value -42 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (-42)::INTEGER::USMALLINT
----
Conversion Error: Type INT32 with value -42 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (-42)::INTEGER::UINTEGER
----
Conversion Error: Type INT32 with value -42 can't be cast because the value is out of range for the destination type UINT32

statement error
SELECT (-42)::INTEGER::UBIGINT
----
Conversion Error: Type INT32 with value -42 can't be cast because the value is out of range for the destination type UINT64

query I
SELECT -42::INTEGER::UTINYINT
----
214

query I
SELECT -42::INTEGER::USMALLINT
----
65494

query I
SELECT -42::INTEGER::UINTEGER
----
4294967254

query I
SELECT -42::INTEGER::UBIGINT
----
18446744073709551574

statement error
SELECT (-42)::BIGINT::UTINYINT
----
Conversion Error: Type INT64 with value -42 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (-42)::BIGINT::USMALLINT
----
Conversion Error: Type INT64 with value -42 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (-42)::BIGINT::UINTEGER
----
Conversion Error: Type INT64 with value -42 can't be cast because the value is out of range for the destination type UINT32

statement error
SELECT (-42)::BIGINT::UBIGINT
----
Conversion Error: Type INT64 with value -42 can't be cast because the value is out of range for the destination type UINT64

query I
SELECT -42::BIGINT::UTINYINT
----
214

query I
SELECT -42::BIGINT::USMALLINT
----
65494

query I
SELECT -42::BIGINT::UINTEGER
----
4294967254

query I
SELECT -42::BIGINT::UBIGINT
----
18446744073709551574

statement error
SELECT (-42)::FLOAT::UTINYINT
----
Conversion Error: Type FLOAT with value -42.0 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (-42)::FLOAT::USMALLINT
----
Conversion Error: Type FLOAT with value -42.0 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (-42)::FLOAT::UINTEGER
----
Conversion Error: Type FLOAT with value -42.0 can't be cast because the value is out of range for the destination type UINT32

statement error
SELECT (-42)::FLOAT::UBIGINT
----
Conversion Error: Type FLOAT with value -42.0 can't be cast because the value is out of range for the destination type UINT64

query I
SELECT -42::FLOAT::UTINYINT
----
214

query I
SELECT -42::FLOAT::USMALLINT
----
65494

query I
SELECT -42::FLOAT::UINTEGER
----
4294967254

query I
SELECT -42::FLOAT::UBIGINT
----
18446744073709551574

statement error
SELECT (-42)::DOUBLE::UTINYINT
----
Conversion Error: Type DOUBLE with value -42.0 can't be cast because the value is out of range for the destination type UINT8

statement error
SELECT (-42)::DOUBLE::USMALLINT
----
Conversion Error: Type DOUBLE with value -42.0 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (-42)::DOUBLE::UINTEGER
----
Conversion Error: Type DOUBLE with value -42.0 can't be cast because the value is out of range for the destination type UINT32

statement error
SELECT (-42)::DOUBLE::UBIGINT
----
Conversion Error: Type DOUBLE with value -42.0 can't be cast because the value is out of range for the destination type UINT64

query I
SELECT -42::DOUBLE::UTINYINT
----
214

query I
SELECT -42::DOUBLE::USMALLINT
----
65494

query I
SELECT -42::DOUBLE::UINTEGER
----
4294967254

query I
SELECT -42::DOUBLE::UBIGINT
----
18446744073709551574

# Convert unsigned to signed
statement error
SELECT (200)::UTINYINT::TINYINT
----
Conversion Error: Type UINT8 with value 200 can't be cast because the value is out of range for the destination type INT8

query I
SELECT (10)::UTINYINT::TINYINT
----
10

query I
SELECT (10)::UTINYINT::SMALLINT
----
10

query I
SELECT (10)::UTINYINT::INTEGER
----
10

query I
SELECT (10)::UTINYINT::BIGINT
----
10

statement error
SELECT (200)::USMALLINT::TINYINT
----
Conversion Error: Type UINT16 with value 200 can't be cast because the value is out of range for the destination type INT8

statement error
SELECT (33000)::USMALLINT::SMALLINT
----
Conversion Error: Type UINT16 with value 33000 can't be cast because the value is out of range for the destination type INT16

query I
SELECT (10)::USMALLINT::TINYINT
----
10

query I
SELECT (10)::USMALLINT::SMALLINT
----
10

query I
SELECT (10)::USMALLINT::INTEGER
----
10

query I
SELECT (10)::USMALLINT::BIGINT
----
10

statement error
SELECT (200)::UINTEGER::TINYINT
----
Conversion Error: Type UINT32 with value 200 can't be cast because the value is out of range for the destination type INT8

statement error
SELECT (33000)::UINTEGER::SMALLINT
----
Conversion Error: Type UINT32 with value 33000 can't be cast because the value is out of range for the destination type INT16

statement error
SELECT (3147483647)::UINTEGER::INTEGER
----
Conversion Error: Type UINT32 with value 3147483647 can't be cast because the value is out of range for the destination type INT32

query I
SELECT (10)::UINTEGER::TINYINT
----
10

query I
SELECT (10)::UINTEGER::SMALLINT
----
10

query I
SELECT (10)::UINTEGER::INTEGER
----
10

query I
SELECT (10)::UINTEGER::BIGINT
----
10

statement error
SELECT (200)::UBIGINT::TINYINT
----
Conversion Error: Type UINT64 with value 200 can't be cast because the value is out of range for the destination type INT8

statement error
SELECT (33000)::UBIGINT::SMALLINT
----
Conversion Error: Type UINT64 with value 33000 can't be cast because the value is out of range for the destination type INT16

statement error
SELECT (3147483647)::UBIGINT::INTEGER
----
Conversion Error: Type UINT64 with value 3147483647 can't be cast because the value is out of range for the destination type INT32


statement error
SELECT (10223372036854775807)::UBIGINT::INTEGER
----
Conversion Error: Type UINT64 with value 10223372036854775807 can't be cast because the value is out of range for the destination type INT32

query I
SELECT (10)::UBIGINT::TINYINT
----
10

query I
SELECT (10)::UBIGINT::SMALLINT
----
10

query I
SELECT (10)::UBIGINT::INTEGER
----
10

query I
SELECT (10)::UBIGINT::BIGINT
----
10


statement error
SELECT (9223372036854775807)::BIGINT::USMALLINT
----
Conversion Error: Type INT64 with value 9223372036854775807 can't be cast because the value is out of range for the destination type UINT16

statement error
SELECT (9223372036854775807)::BIGINT::UINTEGER
----
Conversion Error: Type INT64 with value 9223372036854775807 can't be cast because the value is out of range for the destination type UINT32

# These should fit though
query I
SELECT (9223372036854775807)::BIGINT::UBIGINT
----
9223372036854775807

query I
SELECT (9223372036854775808)::HUGEINT::UBIGINT
----
9223372036854775808



# Cast Decimal to Unsigned Values
query I
SELECT (200.32)::DECIMAL::UTINYINT
----
200

statement error
SELECT (260.32)::DECIMAL::UTINYINT
----
Conversion Error: Failed to cast decimal value 260 to type UINT8

query I
SELECT (200.32)::DECIMAL::USMALLINT
----
200

query I
SELECT (65535.32)::DECIMAL::USMALLINT
----
65535

statement error
SELECT (65536.32)::DECIMAL::USMALLINT
----
Conversion Error: Failed to cast decimal value 65536 to type UINT16


query I
SELECT (200.32)::DECIMAL::UINTEGER
----
200

query I
SELECT (4294967295.32)::DECIMAL::UINTEGER
----
4294967295

statement error
SELECT (4294967296.32)::DECIMAL::UINTEGER
----
Conversion Error: Failed to cast decimal value 4294967296 to type UINT32

query I
SELECT (200.32)::DECIMAL::UBIGINT
----
200

# Cast REAL to Unsigned Values
query I
SELECT (200.32)::REAL::UTINYINT
----
200

statement error
SELECT (260.32)::REAL::UTINYINT
----
Conversion Error: Type FLOAT with value 260.32 can't be cast because the value is out of range for the destination type UINT8

query I
SELECT (200.32)::REAL::USMALLINT
----
200

query I
SELECT (65534.32)::REAL::USMALLINT
----
65534

statement error
SELECT (65536.32)::REAL::USMALLINT
----
Conversion Error: Type FLOAT with value 65536.32 can't be cast because the value is out of range for the destination type UINT16


query I
SELECT (200.32)::REAL::UINTEGER
----
200

query I
SELECT (200.32)::REAL::UINTEGER
----
200

query I
SELECT (4294967296.32)::REAL::UBIGINT
----
4294967296
