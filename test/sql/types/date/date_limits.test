# name: test/sql/types/date/date_limits.test
# description: Test date limits
# group: [date]

statement ok
PRAGMA enable_verification

# min date: 5877642-06-23 (BC)
query I
select '1969-01-01'::date
----
1969-01-01

query I
select '2370-01-01'::date
----
2370-01-01

query I
select '5877642-06-25 (BC)'::date
----
5877642-06-25 (BC)

statement error
select '5877642-06-24 (BC)'::date
----
Conversion Error: date field value out of range: "5877642-06-24 (BC)", expected format is (YYYY-MM-DD)

statement error
select '5877680-06-23 (BC)'::date
----
Conversion Error: date field value out of range: "5877680-06-23 (BC)", expected format is (YYYY-MM-DD)

statement error
select '99999999-06-23 (BC)'::date
----
Conversion Error: date field value out of range: "99999999-06-23 (BC)", expected format is (YYYY-MM-DD)

# min date for timestamp micros is -290307
query I
select '290308-01-01 (BC)'::date::timestamp
----
290308-01-01 (BC) 00:00:00

statement error
select '290309-01-01 (BC)'::date::timestamp
----
Conversion Error: Type INT32 with value 290309-01-01 (BC) can't be cast to the destination type INT64

statement error
select '5877642-06-23 (BC)'::date::timestamp
----
Conversion Error: date field value out of range: "5877642-06-23 (BC)", expected format is (YYYY-MM-DD)

# date arithmetic
query I
select '5877642-06-25 (BC)'::date + 1
----
5877642-06-26 (BC)

statement error
select '5877642-06-24 (BC)'::date - 1
----
Conversion Error: date field value out of range: "5877642-06-24 (BC)", expected format is (YYYY-MM-DD)

statement error
select '5877642-06-24 (BC)'::date - 365
----
Conversion Error: date field value out of range: "5877642-06-24 (BC)", expected format is (YYYY-MM-DD)

statement error
select '5877642-06-24 (BC)'::date - 2147483647
----
Conversion Error: date field value out of range: "5877642-06-24 (BC)", expected format is (YYYY-MM-DD)

# interval arithmetic
query I
select '5877642-06-25 (BC)'::date + interval (1) day
----
5877642-06-26 (BC)

statement error
select '5877642-06-25 (BC)'::date - interval (1) day
----
Out of Range Error: Date out of range

statement error
select '5877642-06-25 (BC)'::date - interval (365) day
----
Out of Range Error: Date out of range

statement error
select '5877642-06-25 (BC)'::date - interval (2147483647) day
----
Out of Range Error: Date out of range

statement error
select '5877642-06-25 (BC)'::date - interval (9999999999999) second
----
Out of Range Error: Interval value 9999999999999 seconds out of range

statement error
select '5877642-06-25 (BC)'::date - interval (9223372036854775807) microsecond
----
Out of Range Error: Date out of range

statement error
select '5877642-06-25 (BC)'::date - interval '1147483647 days 9223372036854775807 microseconds'
----
Out of Range Error: Date out of range

statement error
select '5877642-06-25 (BC)'::date - interval '2147483647 days 9223372036854775807 microseconds'
----
Out of Range Error: Date out of range

statement error
select '5877642-06-25 (BC)'::date - interval '2007483647 days 9223372036854775807 microseconds'
----
Out of Range Error: Date out of range

query I
select '5877642-06-25 (BC)'::date + interval (1) month
----
5877642-07-25 (BC)

statement error
select '5877642-06-23 (BC)'::date - interval (1) month
----
Conversion Error: date field value out of range: "5877642-06-23 (BC)", expected format is (YYYY-MM-DD)

statement error
select '5877642-06-23 (BC)'::date - interval (2147483647) month
----
Conversion Error: date field value out of range: "5877642-06-23 (BC)", expected format is (YYYY-MM-DD)

# max date: 5881580-07-10
query I
select '5881580-07-10'::date
----
5881580-07-10

statement error
select '5881580-07-11'::date
----
Conversion Error: date field value out of range: "5881580-07-11", expected format is (YYYY-MM-DD)

statement error
select '5881580-08-11'::date
----
Conversion Error: date field value out of range: "5881580-08-11", expected format is (YYYY-MM-DD)

statement error
select '99999999-01-01'::date
----
Conversion Error: date field value out of range: "99999999-01-01", expected format is (YYYY-MM-DD)

# max date for timestamp micros is 294246
query I
select '294246-12-31'::date::timestamp
----
294246-12-31 00:00:00

statement error
select '294247-12-31'::date::timestamp
----
Conversion Error: Type INT32 with value 294247-12-31 can't be cast to the destination type INT64

# arithmetic
query I
select '5881580-07-10'::date - 1
----
5881580-07-09

statement error
select '5881580-07-10'::date + 1
----
Out of Range Error: Date out of range

statement error
select '5881580-07-10'::date + 365
----
PLACEHOLDER_ERROR_MESSAGE622

statement error
select '5881580-07-10'::date + 2147483647
----
PLACEHOLDER_ERROR_MESSAGE621

statement error
SELECT '5877642-06-25 (BC)'::DATE - 1;
----
PLACEHOLDER_ERROR_MESSAGE620

# interval arithmetic
query I
select '5881580-07-10'::date - interval (1) day
----
5881580-07-09

statement error
select '5881580-07-10'::date + interval (1) day
----
PLACEHOLDER_ERROR_MESSAGE619

statement error
select '5881580-07-10'::date + interval (365) day
----
PLACEHOLDER_ERROR_MESSAGE618

statement error
select '5881580-07-10'::date + interval (2147483647) day
----
PLACEHOLDER_ERROR_MESSAGE617

statement error
select '5881580-07-10'::date + interval (9999999999999) second
----
PLACEHOLDER_ERROR_MESSAGE616

statement error
select '5881580-07-10'::date + interval (9223372036854775807) microsecond
----
PLACEHOLDER_ERROR_MESSAGE615

statement error
select '5881580-07-10'::date + interval '1147483647 days 9223372036854775807 microseconds'
----
PLACEHOLDER_ERROR_MESSAGE614

statement error
select '5881580-07-10'::date + interval '2147483647 days 9223372036854775807 microseconds'
----
PLACEHOLDER_ERROR_MESSAGE613

statement error
select '5881580-07-10'::date + interval '2007483647 days 9223372036854775807 microseconds'
----
PLACEHOLDER_ERROR_MESSAGE612

statement error
select '5881580-07-10'::date + interval (1) month
----
PLACEHOLDER_ERROR_MESSAGE611

query I
select '5881580-07-10'::date - interval (1) month
----
5881580-06-10

query I
select '5881580-07-10'::date - '5877642-06-25 (BC)'::date
----
4294967292
