# name: test/sql/types/date/test_date.test
# description: Test basic DATE functionality
# group: [date]

statement ok
PRAGMA enable_verification

# create and insert into table
statement ok
CREATE TABLE dates(i DATE)

statement ok
INSERT INTO dates VALUES ('1993-08-14'), (NULL)

# check that we can select dates
query T
SELECT * FROM dates
----
1993-08-14
NULL

# YEAR function
query I
SELECT year(i) FROM dates
----
1993
NULL

# check that we can convert dates to string
query T
SELECT cast(i AS VARCHAR) FROM dates
----
1993-08-14
NULL

# check that we can add days to a date
query T
SELECT i + 5 FROM dates
----
1993-08-19
NULL

# check that we can subtract days from a date
query T
SELECT i - 5 FROM dates
----
1993-08-09
NULL

# HOWEVER, we can't divide or multiply or modulo
statement error
SELECT i * 3 FROM dates
----
Binder Error: No function matches the given name and argument types '*(DATE, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	*(TINYINT, TINYINT) -> TINYINT
	*(SMALLINT, SMALLINT) -> SMALLINT
	*(INTEGER, INTEGER) -> INTEGER
	*(BIGINT, BIGINT) -> BIGINT
	*(HUGEINT, HUGEINT) -> HUGEINT
	*(FLOAT, FLOAT) -> FLOAT
	*(DOUBLE, DOUBLE) -> DOUBLE
	*(DECIMAL, DECIMAL) -> DECIMAL
	*(UTINYINT, UTINYINT) -> UTINYINT
	*(USMALLINT, USMALLINT) -> USMALLINT
	*(UINTEGER, UINTEGER) -> UINTEGER
	*(UBIGINT, UBIGINT) -> UBIGINT
	*(INTERVAL, BIGINT) -> INTERVAL
	*(BIGINT, INTERVAL) -> INTERVAL

statement error
SELECT i / 3 FROM dates
----
Binder Error: No function matches the given name and argument types '/(DATE, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	/(FLOAT, FLOAT) -> FLOAT
	/(DOUBLE, DOUBLE) -> DOUBLE
	/(INTERVAL, BIGINT) -> INTERVAL

statement error
SELECT i % 3 FROM dates
----
Binder Error: No function matches the given name and argument types '%(DATE, INTEGER)'. You might need to add explicit type casts.
	Candidate functions:
	%(TINYINT, TINYINT) -> TINYINT
	%(SMALLINT, SMALLINT) -> SMALLINT
	%(INTEGER, INTEGER) -> INTEGER
	%(BIGINT, BIGINT) -> BIGINT
	%(HUGEINT, HUGEINT) -> HUGEINT
	%(FLOAT, FLOAT) -> FLOAT
	%(DOUBLE, DOUBLE) -> DOUBLE
	%(UTINYINT, UTINYINT) -> UTINYINT
	%(USMALLINT, USMALLINT) -> USMALLINT
	%(UINTEGER, UINTEGER) -> UINTEGER
	%(UBIGINT, UBIGINT) -> UBIGINT

# we also can't add two dates together
statement error
SELECT i + i FROM dates
----
Binder Error: No function matches the given name and argument types '+(DATE, DATE)'. You might need to add explicit type casts.
	Candidate functions:
	+(TINYINT) -> TINYINT
	+(TINYINT, TINYINT) -> TINYINT
	+(SMALLINT) -> SMALLINT
	+(SMALLINT, SMALLINT) -> SMALLINT
	+(INTEGER) -> INTEGER
	+(INTEGER, INTEGER) -> INTEGER
	+(BIGINT) -> BIGINT
	+(BIGINT, BIGINT) -> BIGINT
	+(HUGEINT) -> HUGEINT
	+(HUGEINT, HUGEINT) -> HUGEINT
	+(FLOAT) -> FLOAT
	+(FLOAT, FLOAT) -> FLOAT
	+(DOUBLE) -> DOUBLE
	+(DOUBLE, DOUBLE) -> DOUBLE
	+(DECIMAL) -> DECIMAL
	+(DECIMAL, DECIMAL) -> DECIMAL
	+(UTINYINT) -> UTINYINT
	+(UTINYINT, UTINYINT) -> UTINYINT
	+(USMALLINT) -> USMALLINT
	+(USMALLINT, USMALLINT) -> USMALLINT
	+(UINTEGER) -> UINTEGER
	+(UINTEGER, UINTEGER) -> UINTEGER
	+(UBIGINT) -> UBIGINT
	+(UBIGINT, UBIGINT) -> UBIGINT
	+(DATE, INTEGER) -> DATE
	+(INTEGER, DATE) -> DATE
	+(INTERVAL, INTERVAL) -> INTERVAL
	+(DATE, INTERVAL) -> DATE
	+(INTERVAL, DATE) -> DATE
	+(TIME, INTERVAL) -> TIME
	+(INTERVAL, TIME) -> TIME
	+(TIMESTAMP, INTERVAL) -> TIMESTAMP
	+(INTERVAL, TIMESTAMP) -> TIMESTAMP
	+(TIME, DATE) -> TIMESTAMP
	+(DATE, TIME) -> TIMESTAMP
	+(ANY[], ANY[]) -> ANY[]

# but we can subtract them! resulting in an integer
query I
SELECT (i + 5) - i FROM dates
----
5
NULL

statement error
SELECT ''::DATE
----
Conversion Error: date field value out of range: "", expected format is (YYYY-MM-DD)

statement error
SELECT '  '::DATE
----
Conversion Error: date field value out of range: "  ", expected format is (YYYY-MM-DD)

statement error
SELECT '1992'::DATE
----
Conversion Error: date field value out of range: "1992", expected format is (YYYY-MM-DD)

statement error
SELECT '1992-'::DATE
----
Conversion Error: date field value out of range: "1992-", expected format is (YYYY-MM-DD)

statement error
SELECT '1992-01'::DATE
----
PLACEHOLDER_ERROR_MESSAGE551

statement error
SELECT '1992-01-'::DATE
----
PLACEHOLDER_ERROR_MESSAGE550

statement error
SELECT '30000307-01-01 (BC)'::DATE
----
PLACEHOLDER_ERROR_MESSAGE549
