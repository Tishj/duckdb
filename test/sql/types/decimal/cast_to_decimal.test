# name: test/sql/types/decimal/cast_to_decimal.test
# description: Test casting from numeric to decimal
# group: [decimal]

statement ok
PRAGMA enable_verification

# tinyint
query IIII
SELECT 100::TINYINT::DECIMAL(18,3), 100::TINYINT::DECIMAL(3,0), (-100)::TINYINT::DECIMAL(3,0), 0::TINYINT::DECIMAL(3,3)
----
100	100	-100	0

query II
SELECT 100::TINYINT::DECIMAL(38,35), 100::TINYINT::DECIMAL(9,6)
----
100	100

# overflow
statement error
SELECT 100::TINYINT::DECIMAL(3,1)
----
Conversion Error: Could not cast value 100 to DECIMAL(3,1)

statement error
SELECT 1::TINYINT::DECIMAL(3,3)
----
Conversion Error: Could not cast value 1 to DECIMAL(3,3)

statement error
SELECT 100::TINYINT::DECIMAL(18,17)
----
Conversion Error: Could not cast value 100 to DECIMAL(18,17)

statement error
SELECT 100::TINYINT::DECIMAL(9,7)
----
Conversion Error: Could not cast value 100 to DECIMAL(9,7)

statement error
SELECT 100::TINYINT::DECIMAL(38,37)
----
Conversion Error: Could not cast value 100 to DECIMAL(38,37)

# smallint
query IIII
SELECT 100::SMALLINT::DECIMAL(18,3), 100::SMALLINT::DECIMAL(3,0), (-100)::SMALLINT::DECIMAL(3,0), 0::SMALLINT::DECIMAL(3,3)
----
100	100	-100	0

query II
SELECT 100::SMALLINT::DECIMAL(38,35), 100::SMALLINT::DECIMAL(9,6)
----
100	100

# overflow
statement error
SELECT 100::SMALLINT::DECIMAL(3,1)
----
Conversion Error: Could not cast value 100 to DECIMAL(3,1)

statement error
SELECT 1::SMALLINT::DECIMAL(3,3)
----
Conversion Error: Could not cast value 1 to DECIMAL(3,3)

statement error
SELECT 100::SMALLINT::DECIMAL(18,17)
----
Conversion Error: Could not cast value 100 to DECIMAL(18,17)

statement error
SELECT 100::SMALLINT::DECIMAL(9,7)
----
Conversion Error: Could not cast value 100 to DECIMAL(9,7)

statement error
SELECT 100::SMALLINT::DECIMAL(38,37)
----
Conversion Error: Could not cast value 100 to DECIMAL(38,37)

# integer
query IIII
SELECT 100::INTEGER::DECIMAL(18,3), 100::INTEGER::DECIMAL(3,0), (-100)::INTEGER::DECIMAL(3,0), 0::INTEGER::DECIMAL(3,3)
----
100	100	-100	0

query IIII
SELECT 100::INTEGER::DECIMAL(38,35), 100::INTEGER::DECIMAL(9,6), 2147483647::INTEGER::DECIMAL(10,0), (-2147483647)::INTEGER::DECIMAL(10,0)
----
100	100	2147483647	-2147483647

# overflow
statement error
SELECT 100::INTEGER::DECIMAL(3,1)
----
Conversion Error: Could not cast value 100 to DECIMAL(3,1)

statement error
SELECT 10000000::INTEGER::DECIMAL(3,1)
----
Conversion Error: Could not cast value 10000000 to DECIMAL(3,1)

statement error
SELECT -10000000::INTEGER::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE341

statement error
SELECT 1::INTEGER::DECIMAL(3,3)
----
PLACEHOLDER_ERROR_MESSAGE340

statement error
SELECT 100::INTEGER::DECIMAL(18,17)
----
PLACEHOLDER_ERROR_MESSAGE339

statement error
SELECT 100::INTEGER::DECIMAL(9,7)
----
PLACEHOLDER_ERROR_MESSAGE338

statement error
SELECT 100::INTEGER::DECIMAL(38,37)
----
PLACEHOLDER_ERROR_MESSAGE337

# bigint
query IIII
SELECT 100::BIGINT::DECIMAL(18,3), 100::BIGINT::DECIMAL(3,0), (-100)::BIGINT::DECIMAL(3,0), 0::BIGINT::DECIMAL(3,3)
----
100	100	-100	0

query IIII
SELECT 100::BIGINT::DECIMAL(38,35), 100::BIGINT::DECIMAL(9,6), 9223372036854775807::BIGINT::DECIMAL(19,0), (-9223372036854775807)::BIGINT::DECIMAL(19,0)
----
100	100	9223372036854775807	-9223372036854775807

query II
SELECT 922337203685477580::BIGINT::DECIMAL(18,0), (-922337203685477580)::BIGINT::DECIMAL(18,0)
----
922337203685477580	-922337203685477580

# overflow
statement error
SELECT 100::BIGINT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE336

statement error
SELECT 10000000::BIGINT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE335

statement error
SELECT -10000000::BIGINT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE334

statement error
SELECT 1::BIGINT::DECIMAL(3,3)
----
PLACEHOLDER_ERROR_MESSAGE333

statement error
SELECT 100::BIGINT::DECIMAL(18,17)
----
PLACEHOLDER_ERROR_MESSAGE332

statement error
SELECT 100::BIGINT::DECIMAL(9,7)
----
PLACEHOLDER_ERROR_MESSAGE331

statement error
SELECT 100::BIGINT::DECIMAL(38,37)
----
PLACEHOLDER_ERROR_MESSAGE330

# hugeint
query IIII
SELECT 100::HUGEINT::DECIMAL(18,3), 100::HUGEINT::DECIMAL(3,0), (-100)::HUGEINT::DECIMAL(3,0), 0::HUGEINT::DECIMAL(3,3)
----
100	100	-100	0

query IIII
SELECT 100::HUGEINT::DECIMAL(38,35), 100::HUGEINT::DECIMAL(9,6), 17014118346046923173168730371588410572::HUGEINT::DECIMAL(38,0), (-17014118346046923173168730371588410572)::HUGEINT::DECIMAL(38,0)
----
100	100	17014118346046923173168730371588410572	-17014118346046923173168730371588410572

# overflow
statement error
SELECT 100::HUGEINT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE329

statement error
SELECT 10000000::HUGEINT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE328

statement error
SELECT -10000000::HUGEINT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE327

statement error
SELECT 1::HUGEINT::DECIMAL(3,3)
----
PLACEHOLDER_ERROR_MESSAGE326

statement error
SELECT 100::HUGEINT::DECIMAL(18,17)
----
PLACEHOLDER_ERROR_MESSAGE325

statement error
SELECT 100::HUGEINT::DECIMAL(9,7)
----
PLACEHOLDER_ERROR_MESSAGE324

statement error
SELECT 100::HUGEINT::DECIMAL(38,37)
----
PLACEHOLDER_ERROR_MESSAGE323

statement error
SELECT 17014118346046923173168730371588410572::HUGEINT::DECIMAL(38,1)
----
PLACEHOLDER_ERROR_MESSAGE322

statement error
SELECT 17014118346046923173168730371588410572::HUGEINT::DECIMAL(37,0)
----
PLACEHOLDER_ERROR_MESSAGE321

statement error
SELECT 17014118346046923173168730371588410572::HUGEINT::DECIMAL(18,0)
----
PLACEHOLDER_ERROR_MESSAGE320

statement error
SELECT 17014118346046923173168730371588410572::HUGEINT::DECIMAL(9,0)
----
PLACEHOLDER_ERROR_MESSAGE319

statement error
SELECT 17014118346046923173168730371588410572::HUGEINT::DECIMAL(4,0)
----
PLACEHOLDER_ERROR_MESSAGE318

# float
query IIII
SELECT 100::FLOAT::DECIMAL(18,3), 100::FLOAT::DECIMAL(3,0), (-100)::FLOAT::DECIMAL(3,0), 0::FLOAT::DECIMAL(3,3)
----
100	100	-100	0

query RRRR
SELECT 100::FLOAT::DECIMAL(38,35)::FLOAT, 100::FLOAT::DECIMAL(9,6)::FLOAT, 17014118346046923173168730371588410572::FLOAT::DECIMAL(38,0)::FLOAT, (-17014118346046923173168730371588410572)::FLOAT::DECIMAL(38,0)::FLOAT
----
100	100	17014118346046923173168730371588410572	-17014118346046923173168730371588410572

query I
SELECT 1.25::FLOAT::DECIMAL(3,2)
----
1.25

# overflow
statement error
SELECT 100::FLOAT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE317

statement error
SELECT 10000000::FLOAT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE316

statement error
SELECT -10000000::FLOAT::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE315

statement error
SELECT 1::FLOAT::DECIMAL(3,3)
----
PLACEHOLDER_ERROR_MESSAGE314

statement error
SELECT 100::FLOAT::DECIMAL(18,17)
----
PLACEHOLDER_ERROR_MESSAGE313

statement error
SELECT 100::FLOAT::DECIMAL(9,7)
----
PLACEHOLDER_ERROR_MESSAGE312

statement error
SELECT 100::FLOAT::DECIMAL(38,37)
----
PLACEHOLDER_ERROR_MESSAGE311

statement error
SELECT 17014118346046923173168730371588410572::FLOAT::DECIMAL(38,1)
----
PLACEHOLDER_ERROR_MESSAGE310

statement error
SELECT 17014118346046923173168730371588410572::FLOAT::DECIMAL(37,0)
----
PLACEHOLDER_ERROR_MESSAGE309

statement error
SELECT 17014118346046923173168730371588410572::FLOAT::DECIMAL(18,0)
----
PLACEHOLDER_ERROR_MESSAGE308

statement error
SELECT 17014118346046923173168730371588410572::FLOAT::DECIMAL(9,0)
----
PLACEHOLDER_ERROR_MESSAGE307

statement error
SELECT 17014118346046923173168730371588410572::FLOAT::DECIMAL(4,0)
----
PLACEHOLDER_ERROR_MESSAGE306

# double
query IIII
SELECT 100::DOUBLE::DECIMAL(18,3), 100::DOUBLE::DECIMAL(3,0), (-100)::DOUBLE::DECIMAL(3,0), 0::DOUBLE::DECIMAL(3,3)
----
100	100	-100	0

query RRRR
SELECT 100::DOUBLE::DECIMAL(38,35)::DOUBLE, 100::DOUBLE::DECIMAL(9,6)::DOUBLE, 17014118346046923173168730371588410572::DOUBLE::DECIMAL(38,0)::DOUBLE, (-17014118346046923173168730371588410572)::DOUBLE::DECIMAL(38,0)::DOUBLE
----
100	100	17014118346046923173168730371588410572	-17014118346046923173168730371588410572

query I
SELECT 1.25::DOUBLE::DECIMAL(3,2)
----
1.25

# overflow
statement error
SELECT 100::DOUBLE::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE305

statement error
SELECT 10000000::DOUBLE::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE304

statement error
SELECT -10000000::DOUBLE::DECIMAL(3,1)
----
PLACEHOLDER_ERROR_MESSAGE303

statement error
SELECT 1::DOUBLE::DECIMAL(3,3)
----
PLACEHOLDER_ERROR_MESSAGE302

statement error
SELECT 100::DOUBLE::DECIMAL(18,17)
----
PLACEHOLDER_ERROR_MESSAGE301

statement error
SELECT 100::DOUBLE::DECIMAL(9,7)
----
PLACEHOLDER_ERROR_MESSAGE300

statement error
SELECT 100::DOUBLE::DECIMAL(38,37)
----
PLACEHOLDER_ERROR_MESSAGE299

statement error
SELECT 17014118346046923173168730371588410572::DOUBLE::DECIMAL(38,1)
----
PLACEHOLDER_ERROR_MESSAGE298

statement error
SELECT 17014118346046923173168730371588410572::DOUBLE::DECIMAL(37,0)
----
PLACEHOLDER_ERROR_MESSAGE297

statement error
SELECT 17014118346046923173168730371588410572::DOUBLE::DECIMAL(18,0)
----
PLACEHOLDER_ERROR_MESSAGE296

statement error
SELECT 17014118346046923173168730371588410572::DOUBLE::DECIMAL(9,0)
----
PLACEHOLDER_ERROR_MESSAGE295

statement error
SELECT 17014118346046923173168730371588410572::DOUBLE::DECIMAL(4,0)
----
PLACEHOLDER_ERROR_MESSAGE294

