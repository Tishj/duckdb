# name: test/sql/types/decimal/decimal_try_cast.test
# description: Test try_cast for decimal
# group: [decimal]

statement ok
PRAGMA enable_verification

# smallint
statement error
SELECT CAST(1000 AS DECIMAL(3,0))
----
PLACEHOLDER_ERROR_MESSAGE401

statement error
SELECT CAST(100 AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE400

statement error
SELECT CAST('100' AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE399

statement error
SELECT CAST('100'::DOUBLE AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE398

statement error
SELECT CAST(100::DECIMAL(3,0) AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE397

statement error
SELECT CAST(10000::DECIMAL(5,0) AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE396

statement error
SELECT CAST(1000000000::DECIMAL(10,0) AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE395

statement error
SELECT CAST(1000000000::DECIMAL(20,0) AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE394

query I
SELECT TRY_CAST(1000 AS DECIMAL(3,0))
----
NULL

query I
SELECT TRY_CAST(100 AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST('100' AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST('100'::DOUBLE AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST(100::DECIMAL(3,0) AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST(10000::DECIMAL(5,0) AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST(1000000000::DECIMAL(10,0) AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST(1000000000::DECIMAL(20,0) AS DECIMAL(2,0))
----
NULL

# integer
statement error
SELECT CAST(1000000 AS DECIMAL(5,0))
----
PLACEHOLDER_ERROR_MESSAGE393

statement error
SELECT CAST('100000' AS DECIMAL(5,0))
----
PLACEHOLDER_ERROR_MESSAGE392

statement error
SELECT CAST('100000'::DOUBLE AS DECIMAL(5,0))
----
PLACEHOLDER_ERROR_MESSAGE391

statement error
SELECT CAST(100000::DECIMAL(6,0) AS DECIMAL(5,0))
----
PLACEHOLDER_ERROR_MESSAGE390

statement error
SELECT CAST(1000000000::DECIMAL(10,0) AS DECIMAL(2,0))
----
PLACEHOLDER_ERROR_MESSAGE389

statement error
SELECT CAST(1000000000::DECIMAL(20,0) AS DECIMAL(5,0))
----
PLACEHOLDER_ERROR_MESSAGE388

query I
SELECT TRY_CAST(1000000 AS DECIMAL(5,0))
----
NULL

query I
SELECT TRY_CAST('100000' AS DECIMAL(5,0))
----
NULL

query I
SELECT TRY_CAST('100000'::DOUBLE AS DECIMAL(5,0))
----
NULL

query I
SELECT TRY_CAST(100000::DECIMAL(6,0) AS DECIMAL(5,0))
----
NULL

query I
SELECT TRY_CAST(1000000000::DECIMAL(10,0) AS DECIMAL(2,0))
----
NULL

query I
SELECT TRY_CAST(1000000000::DECIMAL(20,0) AS DECIMAL(5,0))
----
NULL

# bigint
statement error
SELECT CAST(10000000000 AS DECIMAL(10,0))
----
PLACEHOLDER_ERROR_MESSAGE387

statement error
SELECT CAST('10000000000' AS DECIMAL(10,0))
----
PLACEHOLDER_ERROR_MESSAGE386

statement error
SELECT CAST('10000000000'::DOUBLE AS DECIMAL(10,0))
----
PLACEHOLDER_ERROR_MESSAGE385

statement error
SELECT CAST(10000000000::DECIMAL(11,0) AS DECIMAL(10,0))
----
PLACEHOLDER_ERROR_MESSAGE384

statement error
SELECT CAST(10000000000::DECIMAL(20,0) AS DECIMAL(10,0))
----
PLACEHOLDER_ERROR_MESSAGE383

query I
SELECT TRY_CAST(10000000000 AS DECIMAL(10,0))
----
NULL

query I
SELECT TRY_CAST('10000000000' AS DECIMAL(10,0))
----
NULL

query I
SELECT TRY_CAST('10000000000'::DOUBLE AS DECIMAL(10,0))
----
NULL

query I
SELECT TRY_CAST(10000000000::DECIMAL(11,0) AS DECIMAL(10,0))
----
NULL

query I
SELECT TRY_CAST(10000000000::DECIMAL(20,0) AS DECIMAL(10,0))
----
NULL

# hugeint
statement error
SELECT CAST(100000000000000000000 AS DECIMAL(20,0))
----
PLACEHOLDER_ERROR_MESSAGE382

statement error
SELECT CAST('100000000000000000000' AS DECIMAL(20,0))
----
PLACEHOLDER_ERROR_MESSAGE381

statement error
SELECT CAST('100000000000000000000'::DOUBLE AS DECIMAL(20,0))
----
PLACEHOLDER_ERROR_MESSAGE380

statement error
SELECT CAST(100000000000000000000::DECIMAL(20,0) AS DECIMAL(20,0))
----
PLACEHOLDER_ERROR_MESSAGE379

query I
SELECT TRY_CAST(100000000000000000000 AS DECIMAL(20,0))
----
NULL

query I
SELECT TRY_CAST('100000000000000000000' AS DECIMAL(20,0))
----
NULL

query I
SELECT TRY_CAST('100000000000000000000'::DOUBLE AS DECIMAL(20,0))
----
NULL

query I
SELECT TRY_CAST(100000000000000000000::DECIMAL(25,0) AS DECIMAL(20,0))
----
NULL
